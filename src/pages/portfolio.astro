---
import BaseLayout from '../layouts/BaseLayout.astro';
import portfolioData from '../data/portfolio.json';
---

<BaseLayout 
    title="Portafolio | Edici√≥n Aular üöÄ‚ú®"
    description="Explora nuestros proyectos de branding, dise√±o web y ecommerce. Casos de √©xito que transforman marcas. ¬°Descubre nuestro trabajo! üé®"
>
    <!-- Copyright Simple -->
    <div class="portfolio-copyright">
        Copyright ¬© Edicion Aular 2025. All Rights Reserved.
    </div>
    
    <!-- Slider Container Wrapper -->
    <div class="bringer-slider-wrapper">
        <!-- Slider CON M√ÅSCARA -->
        <div class="swiper bringer-slider" data-duration="800" data-effect="slide" style="clip-path: url(#slider-mask);">
            <div class="swiper-wrapper">
                {portfolioData.map((project, index) => (
                    <div class="swiper-slide has-content">
                        <div class="bringer-slider-media">
                            <img class="bringer-lazy" src="/img/null.png" data-src={project.image} alt={project.title} width="1920" height="1280">
                        </div>
                        <div class="bringer-slide-content">
                            <div class="bringer-slide-content-inner bringer-slide-post-title">
                                <span class="bringer-meta">{project.category}</span>
                                <h4>{project.title}</h4>
                            </div>
                            <a href={`/portfolio/${project.slug}`}></a>
                        </div>
                        <!-- M√°scara individual del slide - NO SE USA -->
                        <svg width="0" height="0">
                            <defs>
                                <clipPath id={`slide-mask-${index}`}>
                                    <path d=""></path>
                                </clipPath>
                            </defs>
                        </svg>
                    </div>
                ))}
            </div>
        </div>
        <!-- Slider Navigation -->
        <div class="bringer-slider-nav on-sides">
            <a href="#" class="bringer-slider-prev">
                <span class="bringer-icon bringer-icon-arrow-left"></span>
            </a>
            <a href="#" class="bringer-slider-next">
                <span class="bringer-icon bringer-icon-arrow-right"></span>
            </a>
        </div>
        
        <!-- M√ÅSCARA PRINCIPAL DEL SLIDER -->
        <svg width="0" height="0">
            <defs>
                <clipPath id="slider-mask">
                    <path d="M0,18 a18,18 0 0 1 18,-18 L98.5%,0 a18,18 0 0 1 18,18 L100%,42.3% a18,18 0 0 1 -18,18 a36,36 0 0 0 -36,36 a36,36 0 0 0 36,36 a18,18 0 0 1 18,18 L100%,97.9% a18,18 0 0 1 -18,18 L18,100% a18,18 0 0 1 -18,-18 L0,57.7% a18,18 0 0 1 18,-18 a36,36 0 0 0 36,-36 a36,36 0 0 0 -36,-36 a18,18 0 0 1 -18,-18 Z"></path>
                </clipPath>
            </defs>
        </svg>
    </div>

    <style>
        /* PORTFOLIO FULLSCREEN - ESTRUCTURA EXACTA DEL ORIGINAL */
        
        /* Main ocupa TODA la pantalla */
        body.bringer-fullscreen-page main#bringer-main {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            z-index: 1;
            padding: 0;
            margin: 0;
        }
        
        body.bringer-fullscreen-page main#bringer-main.is-fullscreen {
            height: 100vh !important;
            min-height: 100vh !important;
        }
        
        body.bringer-fullscreen-page {
            overflow: hidden;
        }
        
        /* Slider wrapper ocupa todo el main */
        .bringer-slider-wrapper {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            margin: 0;
            padding: 0;
        }
        
        /* Bringer slider con M√ÅSCARAS SVG */
        .bringer-slider {
            width: 100%;
            height: 100%;
            border-radius: 0; /* Sin border-radius, usamos SVG mask */
        }
        
        /* Las m√°scaras SVG no son visibles */
        .bringer-slider svg,
        .swiper-slide svg {
            position: absolute;
            pointer-events: none;
            left: 0;
            top: 0;
            opacity: 0;
        }
        
        .swiper-wrapper {
            height: 100%;
        }
        
        .swiper-slide {
            height: 100%;
            position: relative;
        }
        
        /* Wrapper de media con clip-path din√°mico */
        .bringer-slider-media {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        /* Imagen dentro del media wrapper */
        .bringer-slider-media img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            display: block;
        }
        
        /* Header SOBRE el slider */
        body.bringer-fullscreen-page #bringer-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background: rgba(7, 9, 13, 0.90);
            backdrop-filter: blur(10px);
        }
        
        body.bringer-fullscreen-page.no-header-border #bringer-header {
            border-bottom: none;
        }
        
        /* Footer OCULTO en portfolio fullscreen */
        body.bringer-fullscreen-page #bringer-footer {
            display: none !important;
        }
        
        /* Copyright minimalista al fondo */
        .portfolio-copyright {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 200;
            text-align: center;
            padding: 12px 16px;
            font-size: 12px;
            color: rgba(245, 247, 250, 0.8);
            background: rgba(7, 9, 13, 0.9);
            backdrop-filter: blur(12px);
            border-top: 1px solid rgba(245, 247, 250, 0.1);
        }
        
        @media (max-width: 768px) {
            .portfolio-copyright {
                font-size: 11px;
                padding: 12px 16px;
            }
        }
        
        /* Navegaci√≥n del slider */
        .bringer-slider-nav {
            z-index: 110;
        }
        
        /* Recuadro del nombre - POSICI√ìN DIN√ÅMICA */
        .bringer-slide-content {
            position: absolute;
            bottom: 60px; /* Espacio para copyright */
            left: 0; /* Ser√° calculado por JavaScript */
            z-index: 180;
            text-align: center;
        }
        
        .bringer-slide-content-inner {
            background: rgba(0, 0, 0, 0.9);
            padding: 20px 40px 24px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            min-width: 300px;
        }
        
        .bringer-slide-content-inner .bringer-meta {
            opacity: 0.75;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            display: block;
            margin-bottom: 8px;
            color: var(--bringer-s-heading-fade);
        }
        
        .bringer-slide-content-inner h4 {
            margin: 0;
            font-size: 2rem;
            font-weight: 600;
            color: var(--bringer-s-heading);
        }
        
        .bringer-slide-content a {
            position: absolute;
            inset: 0;
            z-index: 10;
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .bringer-slide-content {
                bottom: 55px;
            }
            
            .bringer-slide-content-inner {
                padding: 18px 35px 20px;
                min-width: 280px;
            }
            
            .bringer-slide-content-inner h4 {
                font-size: 1.75rem;
            }
        }
        
        @media (max-width: 768px) {
            .bringer-slider-media img {
                object-fit: contain;
            }
            
            .bringer-slide-content {
                bottom: 50px;
            }
            
            .bringer-slide-content-inner {
                padding: 16px 30px 18px;
                min-width: 260px;
            }
            
            .bringer-slide-content-inner h4 {
                font-size: 1.5rem;
            }
            
            .bringer-slide-content-inner .bringer-meta {
                font-size: 11px;
            }
        }
        
        @media (max-width: 575px) {
            /* Desactivar m√°scaras en m√≥vil para mejor visualizaci√≥n */
            .bringer-slider {
                clip-path: none !important;
            }
            
            .bringer-slide-content {
                bottom: 45px;
                /* Posici√≥n left calculada por JavaScript */
            }
            
            .bringer-slide-content-inner {
                padding: 14px 24px 16px;
                min-width: 240px;
                max-width: calc(100vw - 40px);
            }
            
            .bringer-slide-content-inner h4 {
                font-size: 1.35rem;
            }
            
            .bringer-slide-content-inner .bringer-meta {
                font-size: 10px;
                margin-bottom: 6px;
            }
        }
    </style>

    <script is:inline>
        // CLASES EXACTAS DEL ORIGINAL + ELIMINAR FOOTER
        document.addEventListener('DOMContentLoaded', function() {
            // Agregar clases al body
            document.body.classList.add(
                'bringer-fullscreen-page',
                'no-header-border',
                'no-footer-border',
                'disable-smooth-scroll'
            );
            
            // Agregar clase al main
            const main = document.getElementById('bringer-main');
            if (main) {
                main.classList.add('is-fullscreen');
            }
            
            // ELIMINAR el footer completamente del DOM
            const removeFooter = function() {
                const footer = document.getElementById('bringer-footer');
                if (footer) {
                    footer.remove();
                }
                
                const footerWidgets = document.querySelector('.bringer-footer-widgets');
                if (footerWidgets) {
                    footerWidgets.remove();
                }
            };
            
            removeFooter();
            setTimeout(removeFooter, 100);
            setTimeout(removeFooter, 500);
            
            // POSICI√ìN DIN√ÅMICA DEL T√çTULO + VARIABLES CSS (copiado del main.js original)
            setTimeout(function() {
                // Variables CSS para el slider-nav
                const sliderNav = document.querySelector('.bringer-slider-nav');
                if (sliderNav) {
                    sliderNav.style.setProperty('--masked-border-radius', '18');
                    sliderNav.style.setProperty('--masked-inner-radius', '36');
                }
                
                const slides = document.querySelectorAll('.swiper-slide');
                slides.forEach((slide, i) => {
                    // Agregar variables CSS para border-radius de slides
                    slide.style.setProperty('--masked-border-radius', '18');
                    slide.style.setProperty('--masked-inner-radius', '24');
                    
                    const slideContent = slide.querySelector('.bringer-slide-content');
                    if (slideContent) {
                        // Funci√≥n para calcular posici√≥n
                        const calculatePosition = function() {
                            const tw = slide.offsetWidth;  // total width
                            const cw = slideContent.offsetWidth; // content width
                            const cpl = 0.5 * (tw - cw); // content point left (centrado)
                            
                            slideContent.style.left = cpl + 'px';
                            slideContent.style.transform = 'none'; // Remover el translateX
                        };
                        
                        calculatePosition();
                        
                        // Recalcular en resize
                        window.addEventListener('resize', function() {
                            setTimeout(calculatePosition, 100);
                        });
                    }
                });
            }, 500);
        });
    </script>
</BaseLayout>
